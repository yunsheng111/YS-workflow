---
description: '后端专项工作流（研究→构思→计划→执行→优化→评审），Codex 主导'
---

# Backend - 后端专项开发

后端专项开发，Codex 主导分析和审查。

## 使用方法

```bash
/backend <后端任务描述>
```

---

## Level 1: 智能路由层

### 步骤 1：增强需求
调用 `mcp______enhance` 增强后端需求：
- 明确 API 设计、数据模型、性能要求、安全约束
- 降级链：`mcp__ace-tool__enhance_prompt` → Claude 自增强

### 步骤 2：推荐方案
基于增强后的需求，推荐执行方案：
- 分析是否需要数据库变更、API 设计、性能优化
- 推荐使用 `backend-agent` 或其他相关代理
- 说明执行策略和技术选型

### 步骤 3：用户确认
使用 `mcp______zhi` 展示推荐方案并等待用户确认：
- 确认选项：["执行推荐方案", "调整方案", "修改需求", "取消"]

### 步骤 4：上下文检索
确认后、进入 Level 2 前，调用 `mcp__ace-tool__search_context` 获取后端代码上下文：
- 降级链：`mcp______sou` → Grep/Glob

### ⛔ 硬门禁
**未完成 Level 1 禁止进入 Level 2**。必须完成 enhance + 命令推荐 + 用户确认 + 上下文检索。

---

## Level 2: 命令层执行

**执行方式**：Task 调用代理

**代理**：`backend-agent`

**调用**：
```
Task({
  subagent_type: "backend-agent",
  prompt: "$ARGUMENTS",
  description: "后端专项开发"
})
```

---

## Level 3: 工具层执行

**代理调用的工具**：
- 代码检索：`mcp__ace-tool__search_context`
- 外部模型：Codex（后端权威）+ Gemini（辅助参考）
- 用户确认：`mcp______zhi`
- 知识存储：`mcp______ji`

**详细说明**：参考 [backend-agent.md](../../agents/ccg/backend-agent.md)

> 仅列关键工具，完整清单见代理文件

---

## 执行流程（概述）

backend-agent 将执行以下 6 阶段工作流：

1. **增强需求**（可选）— 结构化技术需求
2. **检索上下文** — 获取相关代码和配置
3. **Codex 分析** — 技术分析和架构规划
4. **实施** — 代码开发
5. **Codex 审查** — 代码审查和优化
6. **评审** — 最终评估

---

## 适用场景

| 场景 | 示例 |
|------|------|
| API 开发 | "实现用户认证 API" |
| 数据库设计 | "设计订单表结构" |
| 业务逻辑 | "实现支付流程" |
| 性能优化 | "优化查询性能" |

---

## 关键规则

1. **Codex 后端意见可信赖**
2. **Gemini 后端意见仅供参考**
3. 外部模型对文件系统**零写入权限**
4. Claude 负责所有代码写入和文件操作
