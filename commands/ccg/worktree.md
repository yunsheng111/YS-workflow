---
description: 'ç®¡ç† Git Worktreeï¼šåœ¨ ../.ccg/é¡¹ç›®å/ ç›®å½•åˆ›å»ºï¼Œæ”¯æŒ IDE é›†æˆå’Œå†…å®¹è¿ç§»'
---

# Worktree - Git Worktree ç®¡ç†

åœ¨ç»“æ„åŒ–ç›®å½•ç®¡ç† Git worktreeï¼Œæ”¯æŒæ™ºèƒ½é»˜è®¤å’Œ IDE é›†æˆã€‚

## ä½¿ç”¨æ–¹æ³•

```bash
/worktree <add|list|remove|prune|migrate> [options]
```

## å­å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `add <path>` | åˆ›å»ºæ–° worktree |
| `list` | åˆ—å‡ºæ‰€æœ‰ worktree |
| `remove <path>` | åˆ é™¤æŒ‡å®š worktree |
| `prune` | æ¸…ç†æ— æ•ˆå¼•ç”¨ |
| `migrate <target>` | è¿ç§»å†…å®¹åˆ°ç›®æ ‡ worktree |

## é€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ |
|------|------|
| `-b <branch>` | åˆ›å»ºæ–°åˆ†æ”¯ |
| `-o, --open` | åˆ›å»ºåç”¨ IDE æ‰“å¼€ |
| `--from <source>` | è¿ç§»æºè·¯å¾„ |
| `--stash` | è¿ç§» stash å†…å®¹ |
| `--track` | è·Ÿè¸ªè¿œç¨‹åˆ†æ”¯ |
| `--detach` | åˆ†ç¦» HEAD |
| `--lock` | é”å®š worktree |

---

## Level 2: å‘½ä»¤å±‚æ‰§è¡Œ

**æ‰§è¡Œæ–¹å¼**ï¼šä¸»ä»£ç†ç›´æ¥æ‰§è¡Œ

**å·¥ä½œæµ**ï¼šæ ¹æ®å­å‘½ä»¤æ‰§è¡Œä¸åŒæµç¨‹ï¼ˆadd/list/remove/prune/migrateï¼‰

---

## Level 3: å·¥å…·å±‚æ‰§è¡Œ

**ä¸»ä»£ç†è°ƒç”¨çš„å·¥å…·**ï¼š
- Git æ“ä½œï¼šBashï¼ˆgit worktree add/list/remove/pruneï¼‰
- ç”¨æˆ·ç¡®è®¤ï¼š`mcp______zhi` â†’ `AskUserQuestion`
- çŸ¥è¯†å­˜å‚¨ï¼š`mcp______ji` â†’ æœ¬åœ°æ–‡ä»¶

**è¯¦ç»†è¯´æ˜**ï¼šå‚è€ƒ [æ¶æ„æ–‡æ¡£ - å·¥å…·è°ƒç”¨ä¼˜å…ˆçº§](./.doc/framework/ccg/ARCHITECTURE.md#å·¥å…·è°ƒç”¨ä¼˜å…ˆçº§)

---

## ç›®å½•ç»“æ„

```
parent-directory/
â”œâ”€â”€ your-project/           # ä¸»é¡¹ç›®
â”‚   â”œâ”€â”€ .git/
â”‚   â””â”€â”€ src/
â””â”€â”€ .ccg/                   # worktree ç®¡ç†ç›®å½•
    â””â”€â”€ your-project/
        â”œâ”€â”€ feature-ui/     # åŠŸèƒ½åˆ†æ”¯
        â”œâ”€â”€ hotfix/         # ä¿®å¤åˆ†æ”¯
        â””â”€â”€ debug/          # è°ƒè¯• worktree
```

---

## æ‰§è¡Œå·¥ä½œæµ

### Add - åˆ›å»º Worktree

`[æ¨¡å¼ï¼šåˆ›å»º]`

1. éªŒè¯ Git ä»“åº“
2. è®¡ç®—è·¯å¾„ï¼š`../.ccg/é¡¹ç›®å/<path>`
3. è°ƒç”¨ `mcp______zhi` å±•ç¤ºåˆ›å»ºæ–¹æ¡ˆï¼ˆè·¯å¾„ã€åˆ†æ”¯ã€ç¯å¢ƒæ–‡ä»¶å¤åˆ¶åˆ—è¡¨ï¼‰å¹¶è·å–ç¡®è®¤
4. åˆ›å»º worktree
5. è‡ªåŠ¨å¤åˆ¶ç¯å¢ƒæ–‡ä»¶ï¼ˆ`.env` ç­‰ï¼‰
6. å¯é€‰ï¼šç”¨ IDE æ‰“å¼€

### Migrate - è¿ç§»å†…å®¹

`[æ¨¡å¼ï¼šè¿ç§»]`

1. éªŒè¯æºæœ‰æœªæäº¤å†…å®¹
2. ç¡®ä¿ç›®æ ‡å¹²å‡€
3. è°ƒç”¨ `mcp______zhi` å±•ç¤ºå³å°†è¿ç§»çš„æ”¹åŠ¨åˆ—è¡¨å¹¶è·å–ç¡®è®¤
4. å®‰å…¨è¿ç§»
5. ç¡®è®¤ç»“æœ

---

## ç¤ºä¾‹

```bash
# åŸºæœ¬åˆ›å»º
/worktree add feature-ui

# åˆ›å»ºå¹¶ç”¨ IDE æ‰“å¼€
/worktree add feature-ui -o

# åˆ›å»ºæŒ‡å®šåˆ†æ”¯
/worktree add hotfix -b fix/login -o

# è¿ç§»æœªæäº¤å†…å®¹
/worktree migrate feature-ui --from main

# è¿ç§» stash å†…å®¹
/worktree migrate feature-ui --stash

# ç®¡ç†æ“ä½œ
/worktree list
/worktree remove feature-ui
/worktree prune
```

## è¾“å‡ºç¤ºä¾‹

```
âœ… Worktree created at ../.ccg/é¡¹ç›®å/feature-ui
âœ… å·²å¤åˆ¶ .env
âœ… å·²å¤åˆ¶ .env.local
ğŸ“‹ å·²ä» .gitignore å¤åˆ¶ 2 ä¸ªç¯å¢ƒæ–‡ä»¶
ğŸ–¥ï¸ æ˜¯å¦åœ¨ IDE ä¸­æ‰“å¼€ï¼Ÿ[y/n]: y
ğŸš€ æ­£åœ¨ç”¨ VS Code æ‰“å¼€...
```

---

## æ™ºèƒ½ç‰¹æ€§

1. **æ™ºèƒ½é»˜è®¤** â€“ æœªæŒ‡å®šåˆ†æ”¯æ—¶ä½¿ç”¨è·¯å¾„å
2. **IDE é›†æˆ** â€“ è‡ªåŠ¨æ£€æµ‹ VS Code / Cursor / WebStorm
3. **ç¯å¢ƒæ–‡ä»¶** â€“ è‡ªåŠ¨å¤åˆ¶ `.gitignore` ä¸­çš„ `.env` æ–‡ä»¶
4. **è·¯å¾„å®‰å…¨** â€“ å§‹ç»ˆä½¿ç”¨ç»å¯¹è·¯å¾„é˜²æ­¢åµŒå¥—é—®é¢˜
5. **åˆ†æ”¯ä¿æŠ¤** â€“ éªŒè¯åˆ†æ”¯æœªè¢«å…¶ä»–åœ°æ–¹ä½¿ç”¨

## æ³¨æ„äº‹é¡¹

- Worktree å…±äº« `.git` ç›®å½•ï¼ŒèŠ‚çœç£ç›˜ç©ºé—´
- è¿ç§»ä»…é™æœªæäº¤æ”¹åŠ¨ï¼Œå·²æäº¤å†…å®¹ç”¨ `git cherry-pick`
- æ”¯æŒ Windowsã€macOSã€Linux
- åˆ›å»º/è¿ç§»/åˆ é™¤æ“ä½œå®Œæˆåï¼Œè°ƒç”¨ `mcp______ji` å½’æ¡£ worktree æ“ä½œè®°å½•ï¼ˆ`action`: "è®°å¿†"ï¼Œ`category`: "context"ï¼Œ`content`: "worktree|æ“ä½œ:<add/migrate/remove>|åˆ†æ”¯:<branch>|è·¯å¾„:<path>"ï¼‰ï¼Œä¾›åç»­ä¼šè¯æŸ¥è¯¢ worktree å†å²
