# B 组对比报告：5 个本地增强命令文件

> 生成时间：2026-02-12
> 上游目录：`D:/Program Files/nvm/node_global/node_modules/ccg-workflow/templates/commands/`
> 本地目录：`C:/Users/Administrator/.claude/commands/ccg/`

---

## 总体差异概览

| 文件 | 上游大小 | 本地大小 | 增幅 | 本地新增核心能力 |
|------|----------|----------|------|-----------------|
| workflow.md | 7067B (191行) | 15283B (433行) | +116% | GrokSearch、zhi确认、ji存储、GitHub MCP（分支+PR）、Chrome DevTools、阶段7 |
| review.md | 4321B (140行) | 11149B (340行) | +158% | GrokSearch、zhi确认、ji存储、GitHub MCP（PR审查+合并+Issue）、阶段5-6 |
| commit.md | 2474B (123行) | 4584B (207行) | +85% | zhi确认、GitHub MCP（推送）、阶段6 |
| debug.md | 4636B (156行) | 7177B (222行) | +55% | GrokSearch、zhi确认、ji存储、GitHub MCP（Issue）、阶段6 |
| frontend.md | 5261B (167行) | 7107B (200行) | +35% | GrokSearch、zhi确认、ji存储、Chrome DevTools |

### 本地增强的 5 个通用模式

所有 5 个文件均遵循以下增强模式（上游均无）：

1. **三术(zhi)确认**：所有关键决策点使用 `mcp______zhi` 替代上游的 `AskUserQuestion` 或纯 Markdown 输出
2. **GrokSearch 网络搜索规范**：独立章节，5 步降级策略（4个文件有，commit.md 无）
3. **ji 知识存储**：工作流完成后调用 `mcp______ji` 存储经验（4个文件有，commit.md 无）
4. **GitHub MCP 集成**：各文件按职责集成不同的 GitHub MCP 工具
5. **路径硬编码为 Windows 绝对路径**：`C:/Users/Administrator/.claude/bin/codeagent-wrapper.exe`

### 上游有而本地缺失的 3 个通用特性

1. **`{{LITE_MODE_FLAG}}`**：上游所有文件使用此占位符支持精简模式，本地全部移除
2. **`{{GEMINI_MODEL_FLAG}}`**：上游使用此占位符和单独的"模型参数说明"段，本地移除（部分硬编码或省略）
3. **`{{WORKDIR}}` / 多工作区检测**：上游有工作目录占位符和多工作区说明，本地替换为 `$PWD`

---

## 1. workflow.md 详细对比

**上游**：191 行 | **本地**：433 行 | **增幅**：+116%

### 1.1 description（YAML front matter）

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 阶段名称 | 研究→构思→计划→执行→**优化→评审** | 研究→构思→计划→执行→**审查与修复→验收** | **修改** |

**同步建议**：保留本地。本地名称更准确反映实际工作流（"审查与修复"强调修复环节，"验收"比"评审"更明确）。

### 1.2 你的角色 + 协作模型

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 阶段流程描述 | 研究→构思→计划→执行→优化→评审 | 研究→构思→计划→执行→审查与修复→验收 | **修改** |
| 协作模型列表 | Codex / Gemini / Claude | **ace-tool MCP** / Codex / Gemini / Claude | **本地新增** ace-tool |

**同步建议**：保留本地。

### 1.3 核心协议（本地独有章节）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 语言协议 | 无 | 与工具/模型交互用英语，与用户交互用中文 | **本地新增** |
| 代码主权 | 散落在关键规则中 | 提升为核心协议 | **本地提升** |
| Enhance 接管 | 无 | 本命令自带 enhance 流程，全局入口协议的步骤 1-2 由此接管 | **本地新增** |
| 止损机制 | 散落在沟通守则中 | 提升为核心协议 | **本地提升** |
| 阶段回退 | 无 | 阶段 4 实施失败时，可回退到阶段 3 重新规划（需用户确认） | **本地新增** |

**同步建议**：保留本地。核心协议集中管理比散落各处更清晰。

### 1.4 网络搜索规范（本地独有章节）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| GrokSearch 5步流程 | 无 | 完整的 get_config_info → toggle_builtin_tools → web_search → 降级 → ji记录 | **本地新增** |

**同步建议**：保留本地。

### 1.5 多模型调用规范

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 工作目录 | `{{WORKDIR}}` 占位符 + 多工作区检测说明 | `$PWD` 硬编码 | **修改** |
| 可执行路径 | `~/.claude/bin/codeagent-wrapper` | `C:/Users/Administrator/.claude/bin/codeagent-wrapper.exe` | **修改** |
| LITE_MODE_FLAG | `{{LITE_MODE_FLAG}}` 占位符 | 无（已移除） | **上游缺失** |
| GEMINI_MODEL_FLAG | `{{GEMINI_MODEL_FLAG}}` 占位符 + "模型参数说明"段 | 无（已移除） | **上游缺失** |
| 会话复用语法 | `resume xxx`（注释："是 resume，不是 --resume"） | `--resume xxx` | **不一致** |
| 超时等待 Kill 确认 | `AskUserQuestion` | `mcp______zhi` | **修改** |
| 角色提示词路径 | `~/.claude/.ccg/prompts/...` | `C:/Users/Administrator/.claude/.ccg/prompts/...` | **修改** |

**同步建议**：
- **`{{WORKDIR}}`**：考虑从上游同步，保留多工作区检测能力
- **`{{LITE_MODE_FLAG}}`**：考虑从上游同步，以支持精简模式
- **`{{GEMINI_MODEL_FLAG}}`**：考虑从上游同步，以支持模型切换
- **`resume` vs `--resume`**：上游明确注释了"是 resume，不是 --resume"，**本地可能有 bug**，建议同步上游
- 路径硬编码：保留本地（Windows 环境适配）

### 1.6 沟通守则

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 阶段流转名称 | 研究→构思→计划→执行→优化→评审 | 研究→构思→计划→执行→审查与修复→验收 | **修改** |
| 阶段确认工具 | "每个阶段完成后必须请求用户确认" | "每个阶段完成后必须使用三术 (mcp______zhi) 请求用户确认" | **修改** |
| 询问工具 | `AskUserQuestion` | 三术(zhi) | **修改** |

**同步建议**：保留本地。

### 1.7 工作流初始化（本地独有）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| ji 回忆项目历史 | 无 | 调用 `mcp______ji` 回忆项目历史工作流模式、架构决策和开发规范 | **本地新增** |

**同步建议**：保留本地。

### 1.8 阶段 1：研究与分析

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| Prompt 增强 | "按 `/ccg:enhance` 的逻辑执行" | 优先调用 `mcp______enhance` → 降级到 `mcp__ace-tool__enhance_prompt` → 再降级 `mcp______zhi` 确认原始需求 | **修改**（本地更明确降级链） |
| 上下文检索 | `{{MCP_SEARCH_TOOL}}` 占位符 | `mcp__ace-tool__search_context` → 降级 `mcp______sou` → Glob + Grep | **修改**（本地明确降级链） |
| 阶段确认 | 无具体 UI | 完整的 `mcp______zhi` 调用模板（评分展示 + 4个选项） | **本地新增** |

**同步建议**：保留本地。本地将上游的占位符实例化为具体工具链。

### 1.9 阶段 2：方案构思

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 阶段确认 | "等待用户选择" | 完整的 `mcp______zhi` 调用模板（方案对比表 + 4个选项） | **本地新增** |

**同步建议**：保留本地。

### 1.10 阶段 3：详细规划

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 计划存储 | "用户批准后存入 `.claude/plan/任务名.md`" | zhi 确认后存入 | **修改** |
| 阶段确认 | 无 | 完整的 `mcp______zhi` 调用模板（计划摘要 + 4个选项） | **本地新增** |
| 分支管理 | 无 | 完整的分支检测 + `mcp__github__create_branch` + 降级方案 | **本地新增** |

**同步建议**：保留本地。

### 1.11 阶段 4：实施

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| Chrome DevTools 验证门控 | 无 | 完整的 4 步验证流程 + L1/L2/L3 降级策略 | **本地新增** |
| 阶段确认 | 无 | 完整的 `mcp______zhi` 调用模板（变更表 + 4个选项） | **本地新增** |

**同步建议**：保留本地。

### 1.12 阶段 5：审查（上游"优化" vs 本地"审查与修复"）

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 阶段名称 | 代码优化 | 审查与修复 | **修改** |
| 流程 | 审查→用户确认→优化 | 审查→zhi展示问题清单→用户选择修复范围→执行修复 | **修改**（本地更细致） |
| 阶段确认 | 无 | 完整的 `mcp______zhi` 模板（问题统计 + 4个选项） | **本地新增** |

**同步建议**：保留本地。

### 1.13 阶段 6：评审（上游"质量审查" vs 本地"验收"）

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 阶段名称 | 质量审查 | 验收 | **修改** |
| Chrome DevTools 验收 | 无 | screenshot + a11y snapshot + performance trace | **本地新增** |
| 最终确认 | "请求最终用户确认" | 完整的 `mcp______zhi` 模板（完成情况+变更总结+遗留问题+后续建议+4个选项） | **本地新增** |
| 后续操作路由 | 无 | 确认完成/提交代码(ccg:commit)/完整报告/创建PR → 阶段7 | **本地新增** |
| ji 经验存储 | 无 | 调用 `mcp______ji` 存储经验 | **本地新增** |

**同步建议**：保留本地。

### 1.14 阶段 7：GitHub PR 创建（本地独有）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 整个阶段 | 无 | 完整的 PR 创建流程：仓库检测 → 分支获取 → PR标题描述生成 → `mcp__github__create_pull_request` → 降级方案 | **本地新增** |

**同步建议**：保留本地。

### 1.15 关键规则

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 规则 1-3 | 阶段顺序/零写入/强制停止 | 相同 | **一致** |
| 规则 4 | 无 | 阶段 4 失败可回退到阶段 3 | **本地新增** |
| 规则 5 | 无 | 阶段 5 Critical 必须在阶段 6 前修复 | **本地新增** |
| 规则 6 | 无 | 确认完成 = 终止，不自动跳转 PR | **本地新增** |

**同步建议**：保留本地。

---

## 2. review.md 详细对比

**上游**：140 行 | **本地**：340 行 | **增幅**：+158%

### 2.1 多模型调用规范

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 工作目录 | `{{WORKDIR}}` + 多工作区检测 | `$PWD` 硬编码 | **修改** |
| 可执行路径 | `~/.claude/bin/codeagent-wrapper` | `C:/Users/Administrator/.claude/bin/codeagent-wrapper.exe` | **修改** |
| LITE_MODE_FLAG | `{{LITE_MODE_FLAG}}` | 无 | **上游缺失** |
| GEMINI_MODEL_FLAG | `{{GEMINI_MODEL_FLAG}}` + 模型参数说明 | 无 | **上游缺失** |
| 角色提示词路径 | `~/.claude/.ccg/prompts/...` | `C:/Users/Administrator/.claude/.ccg/prompts/...` | **修改** |
| 超时等待 Kill 确认 | `AskUserQuestion` | `mcp______zhi` | **修改** |

**同步建议**：同 workflow.md，考虑同步 `{{LITE_MODE_FLAG}}` 和 `{{GEMINI_MODEL_FLAG}}`。

### 2.2 网络搜索规范（本地独有章节）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| GrokSearch 5步流程 | 无 | 完整 5 步降级流程 | **本地新增** |

**同步建议**：保留本地。

### 2.3 阶段 1：获取待审查代码

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| ji 回忆 | 无 | 调用 `mcp______ji` 回忆项目代码规范和审查标准 | **本地新增** |
| PR 审查流程 | 无 | 完整的 GitHub PR 审查：`get_pull_request` → `get_pull_request_files` → 可选 `update_pull_request_branch` | **本地新增** |
| PR 列表获取 | 无 | `list_pull_requests` → zhi 展示列表供选择 | **本地新增** |
| 上下文检索 | `{{MCP_SEARCH_TOOL}}` | `mcp__ace-tool__search_context` → 降级 `mcp______sou` | **修改** |

**同步建议**：保留本地。

### 2.4 阶段 2：并行审查

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| CI/CD 状态检查 | 无 | `get_pull_request_status` + CI 失败标注 | **本地新增** |
| 提交历史获取 | 无 | `list_commits` 获取 PR 分支提交历史 | **本地新增** |
| ROLE_FILE 路径 | `~/.claude/.ccg/prompts/...` | `C:/Users/Administrator/.claude/.ccg/prompts/...` | **修改** |

**同步建议**：保留本地。

### 2.5 阶段 3：综合反馈

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 内容 | 收集→分类→去重合并 | 相同 | **一致** |

### 2.6 阶段 4：呈现审查结果

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 呈现方式 | 纯 Markdown 代码块 | `mcp______zhi` 工具展示 + 5个选项 | **修改** |
| 后续操作 | 无 | 自动修复/详细分析/导出报告/创建Issue/完成审查 | **本地新增** |
| Issue 创建流程 | 无 | `mcp__github__create_issue` + 降级方案 | **本地新增** |

**同步建议**：保留本地。

### 2.7 阶段 5：GitHub PR 审查（本地独有）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 整个阶段 | 无 | zhi 确认 → `create_pull_request_review` → event 选择规则(Critical→REQUEST_CHANGES/Major→COMMENT/其他→APPROVE) → 降级方案 | **本地新增** |

**同步建议**：保留本地。

### 2.8 阶段 6：GitHub PR 合并（本地独有）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 整个阶段 | 无 | zhi 确认(squash/merge/rebase/暂不合并) → `merge_pull_request` → 降级方案 | **本地新增** |

**同步建议**：保留本地。

### 2.9 关键规则

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 规则 1-3 | 无参数=git diff / 双模型交叉验证 / 零写入 | 相同 | **一致** |

### 2.10 知识存储（本地独有）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| ji 存储 | 无 | 调用 `mcp______ji` 存储审查模式和代码规范偏好 | **本地新增** |

**同步建议**：保留本地。

---

## 3. commit.md 详细对比

**上游**：123 行 | **本地**：207 行 | **增幅**：+85%

### 3.1 description + 使用方法 + 选项

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 全部内容 | 相同 | 相同 | **一致** |

### 3.2 阶段 1-3（仓库校验、改动检测、拆分建议）

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 全部内容 | 相同 | 相同 | **一致** |

### 3.3 阶段 4：生成提交信息

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 阶段标题 | "生成提交信息" | "生成提交信息（使用三术 zhi 确认）" | **修改** |
| 格式/语言规则 | 相同 | 相同 | **一致** |
| 三术确认 | 无 | 完整的 `mcp______zhi` 模板（变更摘要+提交信息预览+变更文件+4个选项） | **本地新增** |
| 选项路由 | 无 | 确认提交/修改信息/查看详细diff/取消 | **本地新增** |

**同步建议**：保留本地。

### 3.4 阶段 5：执行提交

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 内容 | 相同 | 相同 | **一致** |

### 3.5 阶段 6：GitHub 推送（本地独有）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 整个阶段 | 无 | zhi 确认(推送/仅本地/查看详情) → 仓库检测 → `mcp__github__push_files` → 降级 `git push` | **本地新增** |

**同步建议**：保留本地。

### 3.6 Type 与 Emoji 映射 + 示例

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 全部内容 | 相同 | 相同 | **一致** |

### 3.7 关键规则

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 规则 1-4 | 仅用Git/尊重钩子/不改源码/原子提交 | 相同 | **一致** |

**注意**：commit.md 是 5 个文件中唯一没有 GrokSearch 网络搜索规范和 ji 知识存储的文件（合理：提交操作不需要这些能力）。

---

## 4. debug.md 详细对比

**上游**：156 行 | **本地**：222 行 | **增幅**：+55%

### 4.1 description + 使用方法 + 角色

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 全部内容 | 相同 | 相同 | **一致** |

### 4.2 多模型调用规范

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 工作目录 | 文字说明（多工作区检测 + `pwd`）| `$PWD` 硬编码 | **修改** |
| 调用示例格式 | 两段独立 bash 代码块（Codex + Gemini） | 统一的 Bash({ }) 模板 | **修改** |
| 可执行路径 | `~/.claude/bin/codeagent-wrapper` | `C:/Users/Administrator/.claude/bin/codeagent-wrapper.exe` | **修改** |
| Gemini 模型参数 | 硬编码 `--gemini-model gemini-3-pro-preview` | 无（省略） | **上游缺失** |
| LITE_MODE_FLAG | 无（debug 上游也没有此占位符） | 无 | **一致** |
| 角色提示词路径 | `~/.claude/.ccg/prompts/...` | `C:/Users/Administrator/.claude/.ccg/prompts/...` | **修改** |
| 超时等待 Kill 确认 | `AskUserQuestion` | `mcp______zhi` | **修改** |
| 调用规范结构 | 分散在"调用示例"和"并行调用"两段 | 合并为统一的调用语法模板 | **本地优化** |

**同步建议**：
- 本地统一调用模板格式更好，保留
- 上游 debug.md 的 Gemini 模型参数硬编码值得注意，但本地省略也不影响功能

### 4.3 网络搜索规范（本地独有章节）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| GrokSearch 5步流程 | 无 | 完整 5 步降级流程 | **本地新增** |

**同步建议**：保留本地。

### 4.4 阶段 0：Prompt 增强

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 增强方式 | "按 `/ccg:enhance` 的逻辑执行" | 优先 `mcp______enhance` → 降级 `mcp__ace-tool__enhance_prompt` | **修改** |

**同步建议**：保留本地（明确降级链）。

### 4.5 阶段 1：上下文收集

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| ji 回忆 | 无 | 调用 `mcp______ji` 回忆项目历史缺陷模式和已知问题 | **本地新增** |
| 上下文检索 | `{{MCP_SEARCH_TOOL}}` | `mcp__ace-tool__search_context` → 降级 `mcp______sou` | **修改** |

**同步建议**：保留本地。

### 4.6 阶段 2：并行诊断

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| ROLE_FILE 路径 | `~/.claude/.ccg/prompts/...` | `C:/Users/Administrator/.claude/.ccg/prompts/...` | **修改** |
| 其他 | 相同 | 相同 | **一致** |

### 4.7 阶段 3：假设整合

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 全部内容 | 相同 | 相同 | **一致** |

### 4.8 阶段 4：用户确认

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 标题 | "用户确认（Hard Stop）" | "用户确认（使用三术 zhi）" | **修改** |
| 确认方式 | 纯 Markdown 代码块 + "Y/N" | `mcp______zhi` 模板 + 4个选项(确认修复/先验证/详细分析/取消) | **修改** |
| 修复方案展示 | 无 | 新增"**修复方案**：<具体修复步骤>" | **本地新增** |
| 选项路由 | 无 | 4 个选项对应不同后续操作 | **本地新增** |

**同步建议**：保留本地。

### 4.9 阶段 5：修复与验证

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 全部内容 | 相同 | 相同 | **一致** |

### 4.10 阶段 6：创建 GitHub Issue（本地独有）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 整个阶段 | 无 | zhi 确认(创建Issue/仅本地/查看摘要) → 仓库检测 → `mcp__github__create_issue` → 降级方案 | **本地新增** |

**同步建议**：保留本地。

### 4.11 知识存储（本地独有）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| ji 存储 | 无 | 调用 `mcp______ji` 存储缺陷模式和修复方案 | **本地新增** |

**同步建议**：保留本地。

---

## 5. frontend.md 详细对比

**上游**：167 行 | **本地**：200 行 | **增幅**：+35%

### 5.1 description + 使用方法 + 上下文 + 角色

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 全部内容 | 相同 | 相同 | **一致** |

### 5.2 多模型调用规范

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 工作目录 | `{{WORKDIR}}` + 多工作区检测 | `$PWD` 硬编码 | **修改** |
| 可执行路径 | `~/.claude/bin/codeagent-wrapper` | `C:/Users/Administrator/.claude/bin/codeagent-wrapper.exe` | **修改** |
| LITE_MODE_FLAG | `{{LITE_MODE_FLAG}}` | 无 | **上游缺失** |
| Gemini 模型参数 | `--gemini-model gemini-3-pro-preview` 硬编码 | 无（省略） | **上游缺失** |
| 角色提示词路径 | `~/.claude/.ccg/prompts/...` | `C:/Users/Administrator/.claude/.ccg/prompts/...` | **修改** |

**同步建议**：同 workflow.md。

### 5.3 网络搜索规范（本地独有章节）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| GrokSearch 5步流程 | 无 | 完整 5 步降级流程 | **本地新增** |

**同步建议**：保留本地。

### 5.4 沟通守则

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 询问工具 | `AskUserQuestion` | 三术 (`mcp______zhi`) | **修改** |

**同步建议**：保留本地。

### 5.5 阶段 0：Prompt 增强

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 增强方式 | "按 `/ccg:enhance` 的逻辑执行" | 优先 `mcp______enhance` → 降级 `mcp__ace-tool__enhance_prompt` | **修改** |

**同步建议**：保留本地。

### 5.6 阶段 1：研究

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| ji 回忆 | 无 | 调用 `mcp______ji` 回忆项目前端设计规范和组件模式 | **本地新增** |
| 代码检索 | `{{MCP_SEARCH_TOOL}}` | `mcp__ace-tool__search_context` → 降级 `mcp______sou` | **修改** |

**同步建议**：保留本地。

### 5.7 阶段 2-3（构思、计划）

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| ROLE_FILE 路径 | `~/.claude/.ccg/prompts/...` | `C:/Users/Administrator/.claude/.ccg/prompts/...` | **修改** |
| 其他逻辑 | 相同 | 相同 | **一致** |

### 5.8 阶段 4：执行

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| Chrome DevTools 验证门控 | 无 | 完整 6 步验证（navigate + console + evaluate + screenshot + resize + emulate） + L1/L2/L3 降级 | **本地新增** |

**同步建议**：保留本地。这是 frontend.md 最重要的增强之一。

### 5.9 阶段 5-6（优化、评审）

| 维度 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| 阶段 6 Chrome DevTools | 无 | a11y snapshot + 多断点截图 + 移动设备/深色模式模拟 | **本地新增** |
| ROLE_FILE 路径 | `~/.claude/.ccg/prompts/...` | `C:/Users/Administrator/.claude/.ccg/prompts/...` | **修改** |

**同步建议**：保留本地。

### 5.10 知识存储（本地独有）

| 段落 | 上游 | 本地 | 差异类型 |
|------|------|------|----------|
| ji 存储 | 无 | 调用 `mcp______ji` 存储前端设计决策和组件规范 | **本地新增** |

**同步建议**：保留本地。

---

## 综合同步建议

### 需要从上游同步到本地的内容（3 项）

| 优先级 | 内容 | 影响文件 | 原因 |
|--------|------|----------|------|
| **高** | `resume` vs `--resume` 语法 | workflow.md | 上游明确注释"是 `resume`，不是 `--resume`"，本地使用了 `--resume`，可能导致会话复用失败 |
| **中** | `{{LITE_MODE_FLAG}}` 占位符 | workflow.md, review.md, frontend.md | 缺失此标志无法使用精简模式 |
| **中** | `{{GEMINI_MODEL_FLAG}}` / `--gemini-model` 参数 | workflow.md, review.md | 缺失此参数可能导致 Gemini 使用默认模型而非指定版本 |

### 本地独有的增强（全部保留）

| 增强类别 | 涉及文件 | 价值评估 |
|----------|----------|----------|
| 三术(zhi)确认系统 | 全部 5 个 | **高**：提供结构化交互，替代纯文本确认 |
| GrokSearch 网络搜索 | workflow/review/debug/frontend | **高**：提供外部信息获取能力 |
| ji 知识存储 | workflow/review/debug/frontend | **中**：跨会话经验复用 |
| GitHub MCP 集成 | workflow(分支+PR)/review(审查+合并+Issue)/commit(推送)/debug(Issue) | **高**：完整的 GitHub 工作流自动化 |
| Chrome DevTools | workflow/frontend | **高**：前端自动化验证能力 |
| 核心协议集中管理 | workflow | **中**：架构清晰度提升 |
| 阶段回退机制 | workflow | **中**：容错能力 |
| 阶段名称优化 | workflow | **低**：纯命名改进 |

### 本地需要注意的问题

| 问题 | 影响文件 | 说明 |
|------|----------|------|
| `--resume` 可能是 bug | workflow.md | 上游特别注明用 `resume`（不带 `--`），本地用了 `--resume` |
| `$PWD` 替代 `{{WORKDIR}}` | 全部 | 丧失多工作区检测能力，但对单工作区环境无影响 |
| Windows 路径硬编码 | 全部 | 不可移植，但对当前环境正确 |
| Gemini 模型未指定版本 | review.md, debug.md（本地） | 可能使用默认模型而非 `gemini-3-pro-preview` |
